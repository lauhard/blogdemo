import{p as _}from"./parse.d12b0d5b.js";import{j as r}from"./singletons.6ae43439.js";r.disable_scroll_handling;r.goto;r.invalidate;const g=r.invalidateAll;r.preload_data;r.preload_code;r.before_navigate;r.after_navigate;const h=r.apply_action;function A(e){const o=JSON.parse(e);return o.data&&(o.data=_(o.data)),o}function L(e,o=()=>{}){const c=async({action:a,result:n,reset:i})=>{n.type==="success"&&(i!==!1&&HTMLFormElement.prototype.reset.call(e),await g()),(location.origin+location.pathname===a.origin+a.pathname||n.type==="redirect"||n.type==="error")&&h(n)};async function s(a){var u,b,y;a.preventDefault();const n=new URL((u=a.submitter)!=null&&u.hasAttribute("formaction")?a.submitter.formAction:HTMLFormElement.prototype.cloneNode.call(e).action),i=new FormData(e),p=(b=a.submitter)==null?void 0:b.getAttribute("name");p&&i.append(p,((y=a.submitter)==null?void 0:y.getAttribute("value"))??"");const d=new AbortController;let m=!1;const f=await o({action:n,cancel:()=>m=!0,controller:d,data:i,form:e,submitter:a.submitter})??c;if(m)return;let l;try{const t=await fetch(n,{method:"POST",headers:{accept:"application/json","x-sveltekit-action":"true"},cache:"no-store",body:i,signal:d.signal});l=A(await t.text()),l.type==="error"&&(l.status=t.status)}catch(t){if((t==null?void 0:t.name)==="AbortError")return;l={type:"error",error:t}}f({action:n,data:i,form:e,update:t=>c({action:n,result:l,reset:t==null?void 0:t.reset}),result:l})}return HTMLFormElement.prototype.addEventListener.call(e,"submit",s),{destroy(){HTMLFormElement.prototype.removeEventListener.call(e,"submit",s)}}}export{h as a,L as e,g as i};
